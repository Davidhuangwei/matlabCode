function perms=permute(v);%function perms=permute(v);%%Version 1.0%%Generates a matrix whos rows are all combinations of the elements %of vector v, without replacement. The matrix therefore has length(v)!%rows. The input vector is always the first row of the output matrix. %%History:%Written by Rakitin & Srinivasan 10-1-96n=length(v);numperms=prod([1:n]);m=zeros(numperms,n);for i=0:n-1	for j=1:numperms/prod([1:n-i]) %numperms/n-i!		v2=complement(m((j-1)*prod([1:n-i])+1,1:i),v);% length(v2) == n-i		if n-i-1 == 0			p=1;		else			p=n-i-1;		end		for k=1:length(v2) % == n-i			m(((j-1)*(prod([1:n-i])))+((k-1)*prod([1:p]))+1:((j-1)*(prod([1:n-i])))+((k-1)*prod([1:p]))+prod([1:p]),i+1)=v2(k)'*ones(prod([1:p]),1);		end	endendperms=m;