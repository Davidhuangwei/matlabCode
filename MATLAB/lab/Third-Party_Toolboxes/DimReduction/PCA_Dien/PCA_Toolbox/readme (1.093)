{\rtf1\mac\ansicpg10000\uc1 \deff4\deflang1033\deflangfe1033{\upr{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman;}{\f4\fnil\fcharset256\fprq2{\*\panose 00020005000000000000}Times;}}{\*\ud{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman;}{\f4\fnil\fcharset256\fprq2{\*\panose 00020005000000000000}Times;}}}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\widctlpar\faauto\adjustright\rin0\lin0\itap0 \f4\lang1033\cgrid \snext0 Normal;}{\*\cs10 \additive Default Paragraph Font;}{\*\cs15 \additive \ul\cf2 \sbasedon10 Hyperlink;}}{\info{\title PCA_Toolbox 1}{\author Joseph Dien}{\operator Joseph Dien}{\creatim\yr2005\mo2\dy23\hr22\min17}{\revtim\yr2005\mo8\dy2\hr16\min44}{\version19}{\edmins11}{\nofpages7}{\nofwords1366}{\nofchars7790}{\*\company Tulane University}{\nofcharsws9566}{\vern16521}}\ftnbj\aenddoc\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\hyphcaps0\formshade\horzdoc\dgmargin\dghspace120\dgvspace120\dghorigin1701\dgvorigin1984\dghshow0\dgvshow3\jcompress\viewkind4\viewscale100\pgbrdrhead\pgbrdrfoot\nolnhtadjtbl \fet0\sectd \linex0\endnhere\sectdefaultcl {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain \qc\widctlpar\faauto\adjustright\rin0\lin0\itap0 \f4\lang1033\cgrid {\b PCA_Toolbox 1.093\par }\pard \widctlpar\faauto\adjustright\rin0\lin0\itap0 {\par }\pard \fi360\widctlpar\faauto\adjustright\rin0\lin0\itap0 {This Matlab toolbox contains my PCA routines for ERP analysis.  This is a port of my previously used programs which were coded in LabVIEW and used SAS to do the actual PCA.  Please feel free to send me suggestions or bug reports at:  jdien@ku.edu.\par \par This package is intended for running on a Macintosh using version 7.04 of Matlab.  The toolbox has also been used on non-Mac platforms but has not been fully tested so caveat emptor.  On non-Mac platforms you will find a number of files starting with "_" which contain Mac-specific information and can be ignored.  To install, simply add paths to the PCA_Toolbox folder and the subfolders "filetype" and "subroutines".  You will also need the EGIS_Toolbox installed (included, courtesy of EGI) if you wish to input or output EGIS format files.  You will also need Scott Makeig\rquote s excellent eeglab toolbox (}{\field{\*\fldinst { HYPERLINK "http://sccn.ucsd.edu/~scott/ica.html" }{{\*\datafield 00d0c9ea79f9bace118c8200aa004ba90b02000000170000002500000068007400740070003a002f002f007300630063006e002e0075006300730064002e006500640075002f007e00730063006f00740074002f006900630061002e00680074006d006c000000e0c9ea79f9bace118c8200aa004ba90b4a00000068007400740070003a002f002f007300630063006e002e0075006300730064002e006500640075002f007e00730063006f00740074002f006900630061002e00680074006d006c0000000000000000000000}}}{\fldrslt {\cs15\ul\cf2 http://sccn.ucsd.edu/~scott/ica.html}}}{) if you wish to run the InfoMax rotation (ICA).\par }\pard \widctlpar\faauto\adjustright\rin0\lin0\itap0 {\par }{\ul Functions\par }\pard \sl360\slmult1\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {doPCA.m\tab runs the PCA analysis.\par readEGISave.m\tab reads in the data from an EGIS average file.\par {\*\bkmkstart OLE_LINK1}{\*\bkmkstart OLE_LINK2}PCAtoEGISscript{\*\bkmkend OLE_LINK1}{\*\bkmkend OLE_LINK2}.m\tab example script for setting up parameters for PCAtoEGIS.\par PCAtoEGIS.m\tab exports PCA results to an EGIS ave file for plotting, etc.\par PCAtoANOVA.m\tab exports PCA factor scores in a format suitable for ANOVAs.\par stPCAtoEGISscript.m\tab example script for spatiotemporal PCAtoEGIS procedure.\par doPCAst.m\tab conducts second stage of spatiotemporal PCA procedure.\par }{\cf1 readNSmat.m\tab imports matlab files output by NS in data volume format.}{\par }\pard \widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\par Extended instructions are available in the header of each file.  Use the "help" command.  The spatiotemporal and parametric PCA procedures will require more in-depth instructions that will be provided in the future.\par \par Good luck!\par \par Joe\par \par Copyright (2002-5).\par All rights reserved.  Permission to distribute the following files for non-commercial purposes granted, as long as this readme file is included and appropriate credit given.  Permission also given to modify files for own use only.  Please send me a copy of any improvements or modifications that you make so I can benefit from them as well and distribute them to others.  Programs are distributed as is with no warranty given or implied.  Programs are not for medical use or any other application where use or misuse could cause injury.  Users utilize this toolbox at their own risk with no responsibility taken by Dr. Dien for any resulting damage or injury.\par \par \par History\par \par }{\ul Changes from 1.0b1\par }{%age of variance accounted for by each Promax rotated factor returned.  Fixed error in Promax algorithm.  Changed output variable names to more readable names.\par Parametric PCA technique now supported by EGIStoPCA routine.\par \par }{\ul Changes from 1.0b2\par }{Kaiser correction now works when it is turned on.\par Factor scores now correctly computed when relationship matrix is covariance or SSCP matrix.  Factor scores are no longer zero-centered when using SSCP matrix.\par Added spatiotemporal PCA procedure.\par PCAtoEGIS now returns peak latencies of factors.\par Various modifications to improve performance or ease of use.\par \par }{\ul Changes from 1.0b3\par }{Changed factor score calculation to avoid need for generalized inversion of relationship matrix, which could cause singularity problems.\par Dropped output of scoring coefficient matrix for the same reason.\par Fixed Promax factor score computation.\par Changed default factor waveform output to pattern matrix for PCAtoEGIS routine.\par \par }{\ul Changes from 1.0b4\par }{Changed factor scores to unstandardized form to correctly handle variables with non-zero means, especially non-average reference data and ST-PCAs.\par Added peakChan and peakSamp output to PCAtoEGIS routine.\par \par }{\ul Changes from 1.0fc1\par }{Fixed readEGISave bugs for outputting spatial formatted data.\par \par }{\ul Changes from 1.0fc2\par }{Fixed readEGISave bugs when parameters not specified.  Fixed PmxUnPat parameter name in PCAtoEGISscript.\par \par }{\ul Changes from 1.0fc3\par }{Abandoned effort to enable non mean-corrected  factor scores as unworkable.  Added option to superimpose grand average on factor output to facilitate interpretation.\par  Dropped UnPat outputs since not needed.  Made PCAtoEGIS scripts easier to use.\par Percentage accounted for fixed.\par \par }{\ul Changes from 1.0\par }{Added error-checking code to PCAtoEGISscript and stPCAtoEGISscript to make sure the subject, channel, timepoint, and cell parameters match up with the size of the matrices.\par \par }{\ul {\*\bkmkstart OLE_LINK3}{\*\bkmkstart OLE_LINK4}Changes from 1.01\par }{Moved eyeblink correction routines to a separate ICAblink_toolbox.  Modified EGIStoPCA {\*\bkmkend OLE_LINK3}{\*\bkmkend OLE_LINK4}routine to optionally output factor waveforms as a matlab cell array.\par \par }{\ul Changes from 1.02\par }{Fixed bug in parametric PCA output. Fixed EGIStoPCA subject specs to include subject ID number so NetStation will label observations properly and NAvg so BESA will have N= info.\par \par }{\ul Changes from 1.03\par }{Fixed bug in PCAtoEGISscript output of reconstructed factor waveforms for spatiotemporal PCA only.  Implemented non-mean corrected factor scores.\par }{\ul \par Changes from 1.04\par }{Generalized output format of doPCA so that rotations can be Varimax instead of Promax.  To use with existing PCAtoEGIS scripts, replace the portion under the dividing line with the new code.  Added variance correction after Varimax rotation to ensure that factor scores remain unitized, resulting in some improvement in solution output.\par \par }{\ul Changes from 1.05\par }{Option for unrotated output added.  Error introduced in 1.04 fixed regarding computation of non-mean centered factor scores fixed.  Added centroid measure to ANOVA output options.  Fix to latency ANOVA output.  Changed missing values number for parametric PCA from zero to "999."  Modified to work under Matlab 6.5.\par \par }{\ul Changes from 1.06\par }{Added }{\cf1 readNSmat.  Added InfoMax (ICA) rotation option.  Fixed bug in parametric PCA for cells past the first one.  Automatically change bins to 500 for EGIS format output to avoid losing too much resolution if bins are a small number, such as from NS.  Added saving of scores matrix when doing parametric PCA in order to facilitate parametric analysis.  Added option for separate subject output files by PCAtoEGIS to facilitate individual subject source analyses.  Modified cellist feature in readEGISave so that the cells retain their original cell numbers.}{\par \par }{\ul Changes from 1.07\par }{Added option for covariance loadings.  Updated my contact information to University of Kansas.\par \par }{\ul Changes from 1.08\par }{Modified code to treat covariance loading as an alternate weighting scheme to Kaiser normalization since that's what it is.  Modified covariance loadings so that, like Kaiser normalization, it only affects the weights at the Varimax stage, not at the Promax stage.\par \par }{\ul {\*\bkmkstart OLE_LINK9}Changes from 1.090\par }{Bugs fixed in PCAtoEGIS file.  Legal language in this readme file modified.  Grand average option added to doPCA.  ICA option set to reinitialize random number generator with each use and to use non-verbose output.{\*\bkmkend OLE_LINK9}\par \par }{\ul Changes from 1.092}{\ul \par }{Bugs fixed in PCAto}{ANOVA}{ file.  }{EGI Toolkit included courtesy of EGI.  Added error check to PCAtoEGIS.\par \par \page \par }{\ul Known Issues\par }{\par The Infomax rotation option currently does not return a scree plot.  To use, just run the rotation once with Varimax or Promax and use the resulting scree for the Infomax rotation.\par \page \par }{\ul Bibliography\par }{\par }\pard \fi-360\li360\widctlpar\tx2160\faauto\adjustright\rin0\lin360\itap0 {Dien, J., Tucker, D. M., Potts, G., & Hartry, A. (1997). Localization of auditory evoked potentials related to selective intermodal attention. }{\i Journal of Cognitive Neuroscience, 9}{(6), 799-823.\par \par Dien, J. (1998). Addressing misallocation of variance in principal components analysis of event-related potentials. }{\i Brain Topography, 11}{(1), 43-55.\par \par Dien, J. (1999). Differential lateralization of trait anxiety and trait fearfulness: evoked potential correlates. }{\i Personality and Individual Differences, 26}{(1), 333-356.\par \par Dien, J., Frishkoff, G. A., & Tucker, D. M. (2000). Differentiating the N3 and N4 electrophysiological semantic incongruity effects. }{\i Brain & Cognition, 43}{, 148-152.\par \par Dien, J., Frishkoff, G., Cerbonne, A., & Tucker, D. M. (2003). Parametric analysis of event-related potentials in semantic comprehension: Evidence for parallel brain mechanisms. }{\i Cognitive Brain Research, 15}{, 137-153.\par \par Dien, J., Spencer, K. M., & Donchin, E. (2003). Localization of the event-related potential novelty response as defined by principal components analysis. }{\i Cognitive Brain Research, 17}{, 637-650.\par \par }{Dien, J., Spencer, K. M., & Donchin, E. (2004). Parsing the "Late Positive Complex": Mental chronometry and the ERP components that inhabit the neighborhood of the P300. }{\i Psychophysiology, 41}{(5), 665-678.}{\par \par Dien, J., & Frishkoff, G. A. (2004). Principal components analysis of event-related potential datasets. In T. Handy (Ed.), }{\i Event-Related Potentials: A Methods Handbook}{. Cambridge, Mass: MIT Press.\par \par }{Dien, J., Beal, D. J., & Berg, P. (2005). Optimizing principal components analysis of event-related potential analysis: Matrix type, factor loading weighting, extraction, and rotations. }{\i Clinical Neurophysiology, 116}{(8), 1808-1825.}{\par \par Donchin, E., & Heffley, E. (1979). Multivariate analysis of event-related potential data: A tutorial review. In D. Otto (Ed.), }{\i Multidisciplinary perspectives in event-related potential research (EPA 600/9-77-043)}{ (pp. 555-572). Washington, DC: U.S. Government Printing Office.\par \par Spencer, K. M., Dien, J., & Donchin, M. (1999). A componential analysis of the ERP elicited by novel events using a dense electrode array. }{\i Psychophysiology, 36}{, 409-414.\par \par Spencer, K. M., Dien, J., & Donchin, E. (2001). Spatiotemporal Analysis of the Late ERP Responses to Deviant Stimuli. }{\i Psychophysiology, 38}{(2), 343-358.\par }}