cnames = char(...	'HMICL',...	'HMICR',...	'HMINL',...	'HMINR',...	'HMSCL',...	'HMSCR',...	'HMSNL',...	'HMSNR',...	'HWICL',...	'HWICR',...	'HWINL',...	'HWINR',...	'HWSCL',...	'HWSCR',...	'HWSNL',...	'HWSNR',...	'ML   ',...	'MR   ',...	'WL   ',...	'WR   ',...	'IL   ',...	'IR   ',...	'SL   ',...	'SR   ',...	'CL   ',...	'CR   ',...	'NL   ',...	'NR   ',...	'I    ',...	'S    ',...	'C    ',...	'N    ',...	'L    ',...	'R    ');	cellcoll = [...	17 0 0 0 0 0 0 0;...	18 0 0 0 0 0 0 0;...	19 0 0 0 0 0 0 0;...	20 0 0 0 0 0 0 0;...	21 0 0 0 0 0 0 0;...	22 0 0 0 0 0 0 0;...	23 0 0 0 0 0 0 0;...	24 0 0 0 0 0 0 0;...	25 0 0 0 0 0 0 0;...	26 0 0 0 0 0 0 0;...	27 0 0 0 0 0 0 0;...	28 0 0 0 0 0 0 0;...	29 0 0 0 0 0 0 0;...	30 0 0 0 0 0 0 0;...	31 0 0 0 0 0 0 0;...	32 0 0 0 0 0 0 0;...	17 19 21 23 0 0 0 0;...	18 20 22 24 0 0 0 0;...	25 27 29 31 0 0 0 0;...	26 28 30 32 0 0 0 0;...	17 19 25 27 0 0 0 0;...	18 20 26 28 0 0 0 0;...	21 23 29 31 0 0 0 0;...	22 24 30 32 0 0 0 0;... 	17 21 25 29 0 0 0 0;...	18 22 26 30 0 0 0 0;...	19 23 27 31 0 0 0 0;...	20 24 28 32 0 0 0 0;...	17 18 19 20 25 26 27 28;...	21 22 23 24 29 30 31 32;...	17 18 21 22 25 26 29 30;...	19 20 23 24 27 28 31 32;...	17 19 21 23 25 27 29 31;...	18 20 22 24 26 28 30 32];ename = 'LRPhand';PCAmode = 'temp';timePoints = 512;SampleRate = 250;base = 200;	%msec.numchan = 129;bins = 500;cal = 50;numsubs=7;numcells=16;	%number of input cellsnumfacs=11;exclChan=[125 126 127 128 17 14 22 16 11 6 129 55 62 68 73 76 82];	%to avoid having peri-ocular or midline channels chosen as peak channels for ANOVAs.params=[];paramNames=[];EGISname = 'LRP(pro/t/11f/nk)';anovaName = 'LRPfac';%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%You only need to change the variables up to this point%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%tempnogave=zeros(numchan,timePoints);tempgave=zeros(numchan,timePoints);if PCAmode == 'temp'	if timePoints ~= size(FacPat,1)		error('Timepoints variable does not match number of variables in the PmxPat factor pattern matrix');	end;	if (numchan * numsubs * numcells) ~= size(FacScr,1)		error('The product of numsubs, numcells, and numchan does not equal the number of observations in the PmxScr factor score matrix');	end;	if numfacs ~= size(FacPat,2)		error('Numfacs variable does not match number of factors in the PmxPat factor pattern matrix');	end;	for i = 1:numchan		tempgave(i,:)=mean(data(i:numchan:size(data,1),:));	end;elseif PCAmode == 'spat'	if numchan ~= size(FacPat,1)		error('Numchan variable does not match number of variables in the PmxPat factor pattern matrix');	end;	if (timePoints * numsubs * numcells) ~= size(FacScr,1)		error('The product of numsubs, numcells, and timepoints does not equal the number of observations in the PmxScr factor score matrix');	end;	if numfacs ~= size(FacPat,2)		error('Numfacs variable does not match number of factors in the PmxPat factor pattern matrix');	end;	for i = 1:timePoints		tempgave(:,i)=mean(data(i:timePoints:size(data,1),:))';	end;else	error('PCAmode must be set to either temp or spat');end;if length(EGISname) > 27	error('Name of output file (EGISname) too long');end;[peakLatency, peakSamp, peakChan] = PCAtoEGIS(PCAmode, cnames, cellcoll, ename, base, numchan, timePoints, SampleRate, bins, cal, EGISname, indexdata, FacScr, FacPat, varSD, exclChan, tempnogave, 'EGI', 'GAVE', params, paramNames);[peakLatency, peakSamp, peakChan] = PCAtoEGIS(PCAmode, cnames, cellcoll, ename, base, numchan, timePoints, SampleRate, bins, cal, [EGISname '+g'], indexdata, FacScr, FacPat, varSD, exclChan, tempgave, 'EGI', 'GAVE', params, paramNames);eval(['save ' EGISname '.mat']);for i = 1:numfacs;	PCAtoANOVA(FacPat, FacScr, varSD, PCAmode, -(base), numchan, timePoints, bins, numsubs, peakChan(1,i), [1:numcells], peakSamp(1,i), peakSamp(1,i), (1000/SampleRate), 'mean', i, [anovaName num2str(i) '.sa'], 'SC');end;clear tempgave;