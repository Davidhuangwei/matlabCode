<H1 align=center>	ICA Using an Undercomplete Basis Set</H1><P>JV Stone and J Porrill, 1998 (modified this file June 2000).<P>Summary: The tar file has been compressed with gzip on unix.  There are32 matlab files in the tar file.  The demonstration code can run onmachines with small amounts of RAM by adjusting the parameters(i.e. nr, nc, nt) that create the synthetic data in uica.m.To just run the code type: uica('s'), or uica('t'). The demotakes about one minute to run on a new-ish PC.<P>Given a data matrix x containing n samples of a linear combination ofh independent source signals s in each of its m rows, this codeimplements independent component analysis (ICA) for extracting i<=msignal sources (ICs) with a rectangular (m by i) 'unmixing' matrix W.<P>	s = Wx <P>This contrasts with the algorithm described in Bell and Sejnowskiwhich requires that W is square, so that i=m. We refer to this methodas uICA because the number i of basis vectors is less than the number ofICs.<P>This method is described in a technical report: "IndependentComponents Analysis for Signal Separation and Dimension Reduction",and in a submitted paper, "Undercomplete Independent ComponentAnalysis for Signal Separation and Dimension Reduction", both of whichcan be downloaded from http://www.shef.ac.uk/~pc1jvs/. These papersgive a more coherent account of uICA than this README file, which isintended as a guide for using the code.<P><H2 align=center>Why Extract Fewer Sources Than Mxtures?</H2><P>Given a temporal sequence x of M (P by P) images, ICA can be used toextract $M$ spatially independent components (IC) with an (M by M)unmixing matrix $W$.  However, such a matrix may be large. In suchcases, we would like to be able to extract fewer sources thanmixtures.<P>1) A common method for reducing the size of the unmixing matrix W is toperform PCA on the data matrix x, and then to retain the k<m principlecomponents (PCs) with the largest eigenvalues. One advantage of ICA isthat it is insensitive to the RMS amplitude of the indpendentcomponents (ICs) it extracts from the mixtures in x.  However, thereis no a priori reason to suppose that ICs of interest should resideonly within subspaces defined by the k PCs with large eigenvalues.Thus, discarding subspaces using PCA may also discard ICs.<P>2) The reduced dimensionality of the input space x' defined by theretained k PCs may contain more ICs than PCs. That is, if the originalm-D input space x contains h<=m ICs, then as the number k of retainedPCs is reduced there is an increasing likelihood that h<k.  If h<kthen a linear decomposition s'=Wx' of the k mixtures implicit x' intoi<=h sources s' does not exist, and therefore ICA cannot work in thiscase.  (Thanks to Martin McKeown for pointing this out).<P><H3>Using PCA to Remove Redundant Dimensions</H3> <P>Having argued that discarding PCs can compromise ICA, there is nopoint in performing ICA on a data set for which the data spans only asubspace of the m-D input space defined by the m datamixtures. Therefore, it is useful to use PCA in order to discardredundant dimensions in the input space. (This reduces the number ofrows in the unmixing matrix W, whereas uICA reduces the number ofcolumns in W). Using PCA in this manner has no impact on ICA. This isbecause, if only an N-D subspace of the m-D input space contains data,then a maximum of N ICs can be recovered using ICA. Accordingly, PCAis used to remove redundant dimensions in the input data in thedemonstration code. Specifically, the data is sphered by using PCA,and the number of eigenvectors retained is sufficient to account for99% of the input data.<P><H2 align=center>		The Code</H2> <P>The demonstration code perform uICA on a temporal sequence of 2Dimages, and can be used to find either spatially or temporallyindependent components.  Spatial uICA (uICAs) extracts spatiallyindependent components, and temporal uICA (uICAt) extracts temporallyindependent components. Note that uICAs and uICAt differ only in termsof the code used to display results. <P>A particular advantage can be seen when performing uICAt. Given asequence of n images with m pixels in each image, ICA requires an mxmunmixing matrix W. In contrast, uICAt requires an ixm matrix W, wherei<=m is the number of required ICs.<P>(The code also demonstrates how to use PCA (actually SVD) to removenull subspace in the data, and also how to use the results of SVD toview the basis vectors implicitly discovered by ICA, and whichcorrespond to images in uICAt, and sequences in uICAs.  The code alsopermits variable super/sub-Gaussian signals to be extracted.)<P><H3>		Running the Demonstration Code</H3> <P>Main Code Parameters<P>nr = number of rows in each image.<BR>nc = number of columns in each image.<BR>nt = number of image mixtures.<BR>nic = number of ICs extracted from data mixtures (set to between 1 and 4).<BR>4 = number of independent components used to generate data.<BR><P><H3>Spatial uICA</H3> <P>To run the demonstration type to MatLab: <P>> uica('s');<P>The file datas.m constructs h nrxnc images (ICs) that are spatiallyindependent, and produces nt linear mixtures of these independentimages. The spatial variation in each of the ICs is sinusoidal,resulting in a sub-Gaussian distribution of grey-level values in eachIC image. Therefore the output non-linearity of the unmixing system ismatched to the cdf of a signal with sub-Gaussian pdf.<P><H3>Temporal uICA</H3> <P>To run the demonstration type to MatLab: <P>> uica('t');<P>The file datat.m constructs h nrxnc images, and produces nt mixturesof these independent images. The extent to which any two imagescontribute to the image mixtures varies independently over time. Thatis, each image is associated with a temporal sequence (an IC) thatspecifies its 'amplitude' over time, and the temporal sequences ofevery pair of images are independent.<P>The temporal variation in each of the ICs is sinusoidal,resulting in a sub-Gaussian distribution of values in eachIC. Therefore the output non-linearity of the unmixing system ismatched to the cdf of a signal with sub-Gaussian pdf.<P><H3>NOTES</H3> <P>This code has not been widely tested on machines, so it ispossible there will be problems. <P>ICs can be extracted one at a time by setting nic=1, using GSO to'remove' each extracted IC from the mixtures, and re-appplying uICA.See technical report, "Independent Components Analysis For Step-WiseSeparation of Signals" on my www page for details.<P>Developed by John Porrill and Jim Stone (1997).<BR>Modified by Jim Ivins (1998).<BR>Documented (somewhat) by Jim Stone April 1998.<BR>Code debugged to extract any number of ICs by Jim Stone, April 1998.<P><H3>Example Output</H3> <P>For reference, the output of one run of 15-Jun-2000 froma Mac G3 is given below. This run took 41.2109 seconds using MatLab (version=5.2.1.1421).<P><PRE>Èuica('s')SETTING RANDOM NUMBER SEEDS TO 999Images ...Time courses ...mixtures: jsize =  1024  256 mixt: jsize =  1024  256 Doing SVD ...... SVD doneNumber of evecs required to account for 0.99 of data variance = 44 PCs account for 1.000 of data variancepcs: jsize =  1024  4 pct: jsize =  256  4 svdica: neig = 4nic = 4W0: jsize =  4  4Using jfminu ...     1 |    28.445117    28.445117    11 |     6.169940     6.169940    21 |     5.244179     5.244179    31 |     5.167128     5.167128    41 |     5.141305     5.141305    51 |     5.104109    43.684595    61 |     5.079225     5.079225    71 |     5.061851     5.061851    81 |     5.059827     5.062701    91 |     5.056385     5.056385   101 |     5.054738     5.054738   111 |     5.054416     5.060602   121 |     5.054385     5.054385   131 |     5.054353     5.054353   141 |     5.054333     5.054333ans =  -24.9499   -3.1237    0.5054  -25.1429    4.1153  -26.9674  -22.5290   -1.0105    3.9134  -21.1529   26.9019   -0.6512   24.7125    4.7827   -0.0083  -25.1212</PRE><P>	Jim Stone<BR>	j.v.stone@shef.ac.uk<BR>	http://www.shef.ac.uk/~pc1jvs/<P><p><a href="http://www.shef.ac.uk/~pc1jvs/"> Back to J Stone's personal page