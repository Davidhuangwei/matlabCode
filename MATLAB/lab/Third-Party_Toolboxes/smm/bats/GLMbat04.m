analDirs = {...
    '/BEEF01/smm/sm9601_Analysis/2-16-04/analysis/',...
    '/BEEF01/smm/sm9603_Analysis/3-21-04/analysis/',...
    '/BEEF02/smm/sm9608_Analysis/7-17-04/analysis/',...
    '/BEEF02/smm/sm9614_Analysis/4-17-05/analysis/',...
    }
analDirs = {...
    '/BEEF01/smm/sm9601_Analysis/2-13-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-14-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-15-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-16-04/analysis/',...
    '/BEEF01/smm/sm9603_Analysis/3-20-04/analysis/',...
    '/BEEF01/smm/sm9603_Analysis/3-21-04/analysis/',...
   '/BEEF02/smm/sm9608_Analysis/7-15-04/analysis/',...
    '/BEEF02/smm/sm9608_Analysis/7-16-04/analysis/',...
    '/BEEF02/smm/sm9614_Analysis/4-16-05/analysis/',...
    '/BEEF02/smm/sm9614_Analysis/4-17-05/analysis/',...
}

analDirs = {...
    '/BEEF01/smm/sm9601_Analysis/2-13-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-14-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-15-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-16-04/analysis/',...
    '/BEEF01/smm/sm9603_Analysis/3-20-04/analysis/',...
    '/BEEF01/smm/sm9603_Analysis/3-21-04/analysis/',...
    '/BEEF02/smm/sm9608_Analysis/7-16-04/analysis/',...
    '/BEEF02/smm/sm9608_Analysis/7-17-04/analysis/',...
    '/BEEF02/smm/sm9614_Analysis/4-16-05/analysis/',...
    '/BEEF02/smm/sm9614_Analysis/4-17-05/analysis/',...
%    '/BEEF02/smm/sm9608_Analysis/7-15-04/analysis/',...
%     '/BEEF02/smm/sm9608_Analysis/7-15_16_17-04/analysis/',...
%     '/BEEF02/smm/sm9608_Analysis/7-15_16-04/analysis/',...
  '/BEEF02/smm/sm9608_Analysis/7-15_17-04/analysis/',...
    '/BEEF03/smm/KenjiData/ec013_Analysis/ec013.50/analysis/',...
    '/BEEF03/smm/KenjiData/ec014.27/analysis/',...
    '/BEEF03/smm/KenjiData/ec014_Analysis/ec014.16/analysis/',...
    '/BEEF03/smm/KenjiData/ec013_Analysis/ec013.46/analysis/',...
    '/BEEF03/smm/KenjiData/ec014_Analysis/ec014.17/analysis/',...
    }

analDirs = {...
    '/BEEF03/smm/drugs/DrugsAnal/sm9608_448-455/analysis/',...
    '/BEEF03/smm/drugs/DrugsAnal/sm9614_564-575/analysis/',...
    '/BEEF03/smm/drugs/DrugsAnal/sm9614_544-557/analysis/',...
    }

statsAnalFunc = 'GlmWholeModel08';

fileExtCell = {...
                  '.eeg',...
                 '_LinNearCSD121.csd',...
%                  '.csd1',...
%                  '.csd111',...
%                   '_NearAveCSD1.csd',...
                }
            
spectAnalBaseCell = {...
    'CalcRunningSpectra12_noExp_MidPoints_MinSpeed0Win626wavParam4',... %for theta paper
    'CalcRunningSpectra12_noExp_MidPoints_MinSpeed0Win626wavParam8',...
    'RemVsRun05_noExp_MinSpeed5wavParam6Win1250',...
    'RemVsRun04_noExp_MinSpeed5wavParam6Win1250',...
    'RemVsRun04_allTheta_MinSpeed5wavParam6Win1250',...
     'RemVsRun04_allTheta_MinSpeed0wavParam6Win1250',...
   'RemVsRun03_noExp_MinSpeed5wavParam6Win1250'...
   'CalcRunningSpectra14_noExp_MinSpeed5wavParam6Win1250',... %btwn 250 and 400 trials on maze
   'CalcRunningSpectra15_noExp_MinSpeed5wavParam6Win1250',... %used for unit calculation (includes all times)ls
   'CalcRemSpectra06_allTimes_wavParam6Win1250',... %good for units and spectra
   'RemVsRun06_noExp_MinSpeed5wavParam6Win1250',... % for field anal: CalcRunningSpectra14 & CalcRemSpectra06
   'RemVsRun07_noExp_MinSpeed5wavParam6Win1250',... % for unit anal: CalcRunningSpectra15 & CalcRemSpectra06
   'CalcRunningSpectra16_goodRun_MinSpeed0wavParam4Win626',... % for speed/theta analysis
    }
 
spectAnalDir = [spectAnalBaseCell{1} fileExtCell{1}]


depVarCell = {...
                 'powSpec',...
                 'cohSpec',...
                 'cohWavSpec',...
                 'phaseSpec',...
                  'thetaPowIntg6-12Hz',...
                'gammaPowIntg40-120Hz',...
                
                  'gammaPowIntg40-100Hz',...
                  'gammaPowIntg50-100Hz',...
                  'gammaPowIntg50-120Hz',...
                  'gammaPowIntg60-120Hz',...

                  'thetaCohMean6-12Hz',...
                  'gammaCohMean40-120Hz',...
                 'thetaPhaseMean6-12Hz',...
                 'gammaPhaseMean40-120Hz',...
                 
                 'thetaFreq6-12Hz',...
                 'gamma40-120HzComodPhaseSpec',...
                 
                  'thetaPowPeak4-12Hz',...
                  'thetaPowIntg4-12Hz',...
                'gammaPowIntg40-120Hz',...
                 'thetaCohMean4-12Hz',...
                 'gammaCohMean40-120Hz',...
                 'thetaPhaseMean4-12Hz',...
                 'gammaPhaseMean40-120Hz',...
                 
                 'thetaCohWavMean4-12Hz',...
                 'gammaCohWavMean40-120Hz',...
                 
                 'thetaPowLMPeak4-12Hz',...
                 'thetaCohLMPeak4-12Hz',...
                 'thetaCohWavLMPeak4-12Hz',...
                 'thetaPhaseLMPeak4-12Hz',...

                 'thetaFreq4-12Hz',...
                 
                 
                  'thetaPowIntg6-12Hz',...
                 'thetaCohMean6-12Hz',...
                 'thetaPhaseMean6-12Hz',...
                 
                 'thetaFreq6-12Hz',...
                 'thetaFreqLM6-12Hz',...
                  'thetaPowPeak6-12Hz',...
                  
                  'thetaPowLMPeak6-12Hz',...
                  'thetaCohLMPeak6-12Hz',...
                 'thetaPhaseLMPeak6-12Hz',...
                 
                 'peakCCGBin10countBC.mat',...
'gammaCohMean40-120Hz.or',...
'thetaCohMean4-12Hz.or',...
    'gammaCohMean40-120Hz.ECs',...
    'gammaCohMean40-120Hz.ECsm',...
    'gammaCohMean40-120Hz.ECdm',...
    'gammaCohMean40-120Hz.ECd',...
    'gammaCohMean40-120Hz.CA1p',...
    'thetaCohMean4-12Hz.ECs',...
    'thetaCohMean4-12Hz.ECsm',...
    'thetaCohMean4-12Hz.ECdm',...
    'thetaCohMean4-12Hz.ECd',...
    'thetaCohMean4-12Hz.CA1p',...
                 
                }
            
analRoutine = {...
     'MazeAll',...
     'Maze_Sp0GT0'
     'MazeAll_Sp0_Ap0'
     'AlterGoodNoMidP_S0_A0_MRrctg'
     
     'MazeAllNoLGA'
     'MazeAllNoLGA_Sp0_Ap0'
     'MazeNoDANoWPNoLGA_Sp0_Ap0'
     'AlterAllNoLGA_Sp0'...
     'AlterAllNoLGA_Sp0_Ap0'
     'ControlAllNoLGA_Sp0'...
     'ControlAllNoLGA_Sp0_Ap0'
     'AlterGoodNoMidPNoLGA_MRrctg'
     'AlterGoodNoMidPNoLGA_S0_A0_MRrctg'
     'ControlGoodNoMidPNoLGA_MRrctg'
     'ControlGoodNoMidPNoLGA_S0_A0_MRrctg'
     'MazeCenterNoMidPNoLGA_TT'
     'MazeCenterNoMidPNoLGA_S0_A0_TT'
     
     %%%%% Theta MR Analysis %%%%%
     'MazeNoDANoWP_Sp0_Ap0',...
     'AlterGood_MRrctg',...
     'AlterGood_MRcVrtg',...
     'AlterGood_S0_A0_MRrctg',...
     'AlterGood_S0_A0_MRcVrtg',...
     'AlterGood_S0_A0_MRcVrtgEqN',...
     'AlterGood_MRrdctg',...
     'AlterGood_S0_A0_MRrdctg',...
     'AlterGood_MRrctg_ThetaFreqLM',...
     'MazeCenter_TT',...
     'MazeDelay_TT',...     
     'MazeCenter_S0_A0_TT',...
     'MazeCenter_TT_ThetaFreqLM',...
     'AlterCenter_S0_A0_E',...
     'ControlGood_MRrctg',...
     'ControlGood_MRrdctg',...
     'ControlGood_S0_A0_MRrctg',...
     'MazeAll_S1000by250e_A1000by250e',...
     
     'AlterGood_MRrctg_ThetaFreqLM',...
     'MazeCenter_TT_ThetaFreqLM',...
     'AlterGood_MRrctg',...
     'AlterGood_S0_A0_MRrctg',...
     'MazeCenter_TT',...
     'MazeCenter_S0_A0_TT',...
     'AlterGood_MRrdctg',...
     'AlterGood_S0_A0_MRrdctg',...
     'AlterGood_MRcVrtg',...
     'AlterGood_MRcVrtgEqN',...
     ...
     'AlterCenter_S0_A0_E',...
     'AlterAll_S0_A0_E_MRrctg',...
     'AlterAll_S0_A0_E_MRrctg_ExMRrctg',...
     'AlterGood_S0_A0_RL_MRrctg',...
     'AlterGood_S0_A0_RL_MRrctg_RLxMRrctg',...
     'ControlGood_MRrctg',...
     'ControlGood_S0_A0_MRrctg',...
     'MazeAll_S1000by250e_A1000by250e',...
     
     'ControlGood_MRcVrtg',...
     'ControlGood_S0_A0_MRcVrtg',...
     ...
     'AlterGood_MRrdctgw',...
     'AlterGood_S0_A0_MRrdctgw',...
     'AlterGood_MRrctgw',...
     'AlterGood_S0_A0_MRrctgw',...
                'MazeCenterGP_TT',...
                'MazeCenterGP_S0_A0_TT',...
                'Maze_Serial'
                'Rem_Serial'
                'RemVsMaze_Serial',...
                'PhasicVsTonicVsMaze_MolSD2',...
                'PhasicVsTonicVsMaze_MolSD2_EqN',...
                'PhasicVsTonic_LMTF95',...
                'PhasicVsTonic_LMTF50',...
                'PhasicVsTonic_MolSD2',...
                'PhasicVsTonic_MolSD2_EqN',...
                'PhasicVsTonic_LMTF95_EqN',...
                'PhasicVsTonic_LMTF50_EqN',...
                'PhasicVsMaze_MolSD2',...
                'PhasicMolSD2VsPhasicLMTF95'
                'MazeHvsL_TF_LMTF95'
                'PhasicVsTonicVsMaze_LMTF95'
'PhasicVsTonicVsMazeVsRemSerial_MolSD2'
'PhasicVsTonicVsMazeVsRemSerial_LMTF95'
'PhasicVsTonicVsMaze_MolSD2_testNaN'
'PhasicVsTonic_MolSD2',...
'PhasicVsMaze_MolSD2',...
'TonicVsMaze_MolSD2',...
'PhasicVsTonic_MolSD2_EqN',...
'PhasicVsMaze_MolSD2_EqN',...
'TonicVsMaze_MolSD2_EqN',...
'RemVsMaze_SpeedGE5LT10',...
'MazeSerial_SpeedGE5LE10',...
'RemVsMaze_ThetaFreqLMGT7p5LT8p5',...
'RemVsMaze_ThetaFreqLMGT7p75LT8p25',...
'RemVsMaze_ThetaFreqLMGT7p6LT8p1',...
'RemBeforeVsAfterMaze_Beh'
%      'RemVsDrugMaze_DrugBeh',...,...I will try to think carefully about the bare minimum of things that need some timing flexibility and how to automate the rest so there is good flow.
%      'RemVsMaze_Beh',...
%      'RemVsMazeGood_Beh',...
%      'RemVsMaze_Beh_ThetaFreqLM',...
%     'RemVsMaze_Beh_ThetaFreqLM_X',...
%     'Rem_ThetaFreqLM',...
%     'Maze_ThetaFreqLM',...
%    'RemVsMaze_BehXThetaFreqLM',...
    };

TrialDesigLists09(analRoutine,analDirs)

for n=1:length(spectAnalBaseCell)
    for m=1:length(analRoutine)
        for j=1:length(fileExtCell)
            for k=1:length(analDirs)
                cd(analDirs{k})
%                  try
                    GlmWholeAnalysisBatch08(spectAnalBaseCell{n},analRoutine{m},'01',fileExtCell{j},depVarCell)
%                     GlmWholeAnalysisBatch07('RemVsRun01_noExp',analRoutine{m},'01',fileExtCell{j},depVarCell,[],0,0,1250,1)
%                  catch
%                      ReportError(['ERROR:  ' date '  GLMbat02bat  ' analDirs{k}  spectAnalBaseCell{n}  fileExtCell{j} '  ' analRoutine{m} '\n']);
%                  end
             end
        end
    end
end


animalDirs = {...
    {'/BEEF01/smm/sm9601_Analysis/2-13-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-14-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-15-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-16-04/analysis/'},...
    {'/BEEF01/smm/sm9603_Analysis/3-20-04/analysis/',...
    '/BEEF01/smm/sm9603_Analysis/3-21-04/analysis/'},...
    {'/BEEF02/smm/sm9608_Analysis/7-15-04/analysis/',...
    '/BEEF02/smm/sm9608_Analysis/7-16-04/analysis/'},...
    {'/BEEF02/smm/sm9614_Analysis/4-16-05/analysis/',...
    '/BEEF02/smm/sm9614_Analysis/4-17-05/analysis/'},...
    }

animalDirs = {...
    {'/BEEF01/smm/sm9601_Analysis/2-13-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-14-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-15-04/analysis/',...
    '/BEEF01/smm/sm9601_Analysis/2-16-04/analysis/'},...
    {'/BEEF01/smm/sm9603_Analysis/3-20-04/analysis/',...
    '/BEEF01/smm/sm9603_Analysis/3-21-04/analysis/'},...
    {'/BEEF02/smm/sm9608_Analysis/7-16-04/analysis/',...
    '/BEEF02/smm/sm9608_Analysis/7-17-04/analysis/'},...
    {'/BEEF02/smm/sm9614_Analysis/4-16-05/analysis/',...
    '/BEEF02/smm/sm9614_Analysis/4-17-05/analysis/'},...
    }

animalDirs = {...
    {'/BEEF01/smm/sm9601_Analysis/2-16-04/analysis/'},...
    {'/BEEF01/smm/sm9603_Analysis/3-21-04/analysis/'},...
    {'/BEEF02/smm/sm9608_Analysis/7-17-04/analysis/'},...
    {'/BEEF02/smm/sm9614_Analysis/4-17-05/analysis/'},...
    }

animalDirs = {...
    {'/BEEF01/smm/sm9601_Analysis/2-13-04/analysis/'},...
    {'/BEEF01/smm/sm9601_Analysis/2-14-04/analysis/'},...
    {'/BEEF01/smm/sm9601_Analysis/2-15-04/analysis/'},...
    {'/BEEF01/smm/sm9601_Analysis/2-16-04/analysis/'},...
    }
animalDirs = {...
    {'/BEEF01/smm/sm9603_Analysis/3-20-04/analysis/'},...
    {'/BEEF01/smm/sm9603_Analysis/3-21-04/analysis/'},...
    }
animalDirs = {...
    {'/BEEF02/smm/sm9608_Analysis/7-15-04/analysis/'},...
    {'/BEEF02/smm/sm9608_Analysis/7-16-04/analysis/'},...
     {'/BEEF02/smm/sm9608_Analysis/7-17-04/analysis/'},...
    }
animalDirs = {...
    {'/BEEF02/smm/sm9614_Analysis/4-16-05/analysis/'},...
    {'/BEEF02/smm/sm9614_Analysis/4-17-05/analysis/'},...
    }
animalDirs = {...
    {'/BEEF02/smm/sm9608_Analysis/7-15_16_17-04/analysis/'},...
    }
animalDirs = {...
    {'/BEEF02/smm/sm9608_Analysis/7-15_16-04/analysis/'},...
    }
animalDirs = {...
    {'/BEEF03/smm/KenjiData/ec013_Analysis/ec013.46/analysis/'}...
    {'/BEEF03/smm/KenjiData/ec014_Analysis/ec014.17/analysis/'}...
    }


depVarRefLayerCell = {...
    '.ca3Pyr',...
    '.ca1Pyr',...
    }


depVarRefLayer = ...
    '.ca3Pyr'
    '.ca1Pyr'
    ''

chanLocVersion = {...
    'Sel',
    'Min',...
    'Full',...
    'MinRegion'
    'SelRegion'
%    'Full',...
    }

scaleCell = {...
    {[0 10],[-.02 .02],[-.005 .005],[-0.5 0.5],[-0.5 0.5],[-0.5 0.5],[-0.5 0.5]}
    {[0 10],[-.02 .02],[-.005 .005],[-0.75 0.75],[-0.75 0.75],[-0.75 0.75],[-0.75 0.75]}
    {[0 10],[-.02 .02],[-.005 .005],[-0.5 0.5],[-0.5 0.5]}


     {[0 1],[-0.05 0.05],[-0.05 0.05]},...    
     {[0 1],[-0.06 0.06],[-0.06 0.06]},...    
     {[0 1],[-0.075 0.075],[-0.075 0.075]},...    
     {[0 1],[-0.1 0.1],[-0.1 0.1],[-0.1 0.1]},...    
     {[0 1],[-0.125 0.125],[-0.125 0.125]},...    
     {[0 1],[-0.1 0.1],[-0.1 0.1]},...    
     {[0 1],[-0.15 0.15],[-0.1 0.15]},...    
     {[0 1],[-0.2 0.2],[-0.2 0.2]},...    
     {[0 1],[-0.05 0.05],[-0.05 0.05]},...    
     {[0 1],[-25 25],[-25 25]},...    
     {[0 1],[-20 20],[-20 20]},...    
     {[0 1],[-15 15],[-15 15]},...    
     
     {[0 1],[-0.2 0.2],[-0.2 0.2]},...    
     {[0 1],[-0.2 0.2],[-0.2 0.2],[-0.2 0.2]},...    
     {[0 1.5],[-0.5 0.5],[-0.5 0.5],[-0.5 0.5]},...    
    {[0 1],[-3.5e-3 3.5e-3],[-7e-4 7e-4],[-0.05 0.05],[-0.05 0.05]},...
     {[0 1],[-0.05 0.05],[-0.05 0.05]},...    
    {[0 1],[-3.5e-3 3.5e-3],[-7e-4 7e-4],[-0.05 0.05],[-0.05 0.05]},...
    {[0 1],[-3.5e-3 3.5e-3],[-7e-4 7e-4],[-0.05 0.05],[-0.05 0.05],[-0.05 0.05],[-0.05 0.05]},...

    {[0 100],[-0.07 0.07], [-0.07 0.07]},...    
    {[0 100],[-1 1],[-1 1]},...    
    {[0 100],[-2 2],[-2 2]},...    
    {[0 100],[-3 3],[-3 3]},...    
    {[0 100],[-3.5 3.5],[-3.5 3.5]},...    
    {[0 100],[-4 4],[-4 4]},...    
     {[0 100],[-6 6],[-6 6]},...    
     {[0 100],[-7 7],[-7 7]},...    
   {[0 100],[-0.02 0.02],[-0.01 0.01],[-1 1],[-1 1]},...
     {[0 100],[-1 1],[-1 1]},...    
    {[0 100],[-0.02 0.02],[-0.01 0.01],[-1 1],[-1 1]},...
    {[0 100],[-0.1 0.1],[-0.05 0.05],[-4 4],[-4 4],[-4 4],[-4 4]},...
    
    [],...
    {[0 1],[-3.5e-3 3.5e-3],[-7e-4 7e-4],[-0.02 0.02],[-0.02 0.02]},...
    {[0 100],[-1 1],[-1 1]},...    
    {[0 100],[-1 1],[-1 1]},... 
    
    {[-180 180],[-45 45],[-45 45],[-45 45],[-45 45]},...  
    {[],[-30 30],[-30 30],[-30 30],[-30 30]},...  
    {[],[-20 20],[-20 20],[-20 20],[-20 20]},...  
    {[-25 25],[-25 25],[-25 25],[-25 25],[-25 25],[-25 25]},...  
    {[],[-10 10],[-10 10],[-10 10],[-10 10]},...  
    {[],[-10 10],[-10 10],[-10 10]},...  
    [],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]
    {[],[-.5 .5],[-.5 .5],[-15 15],[-15 15]},...  
    {[],[-.5 .5],[-.1 .1],[-15 15],[-15 15]},...
    
    {[0.95 1],[]},...  
    {[0.85 1],[]},...  
    
    
    %%%% Theta Paper Speed/Accel plots %%%%
    {[65 85],[-.075 .075],[-0.01 0.01]}
    {[0 100],[-0.065 0.065],[-0.02 0.02],[-1 1]}
    {[0 100],[-0.070 0.070],[-0.02 0.02]}
    }

saveDir = ...
    'MazePaper/EachAnimal/sm9608_15_16_17merge/'
    'MazePaper/EachAnimal/sm9608_15_16merge/'
    'MazePaper/EachAnimal/sm9608newAll/'
    'REMPaper/EC_02/'
    'REMPaper/'
    'PhasePaper/EachAnimal/'
    'REMPaper/psFigs/new19/'
    'ThetaPaper/'
    'ThetaPaper/NonParam/'
    'ThetaPaper/psFigs/new05/'
    'ThetaPaper/psFigs/new19/'
    'ThetaPaper/NonParam/EachAnimal/'

reportFigBool = ...
    0
    1
    
printFigBool = ...
    0
    1

statAlpha = ...
    0.05
    0.01
    0.001
    
bonfFactor = ...
    1
    1/2
    3/2
    3/4
    
dbstop in PlotGLMResults08 at 50
dbstop in PlotGlmBarh07 at 61
dbstop in PlotGlmCoh13 at 86

for n=1:length(spectAnalBaseCell)
    for k=1:length(chanLocVersion)
        for m=1:length(analRoutine)
            for j=1:length(fileExtCell)
%                 try
%                 PlotGLMResultsBatch08('GlmWholeModel08',[analRoutine{m} '_01'],{[depVarCell{1} repmat(depVarRefLayer,size(depVarCell))]} ,spectAnalBaseCell{n},fileExtCell{j},0,'linear',1)
%                PlotGlmCoh11(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs,scaleCell{m},reportFigBool,printFigBool,[],saveDir,bonfFactor,statAlpha,1,1)
%                PlotGlmCoh13(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs,scaleCell{m},reportFigBool,printFigBool,[],saveDir,bonfFactor,statAlpha,1,1)
%                 PlotGlmBarh07(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs,scaleCell{m},reportFigBool,printFigBool,[],saveDir,bonfFactor,statAlpha)
                PlotGlmMultCompare01(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs,scaleCell{m},reportFigBool,printFigBool,[],saveDir,bonfFactor,statAlpha)
%                 PlotGlmBarh06(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs,scaleCell{m},reportFigBool,printFigBool,[],saveDir,bonfFactor,statAlpha)
%                PlotGlmScat12(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs,scaleCell{m},reportFigBool,[],saveDir,statAlpha)
%                 if figPrintBool
%                     print(1,'-depsc2',[depVarCell{p} '_' analRoutine{m} Dot2Underscore(fileExtCell{j}) '_bf' Dot2Underscore(num2str(bonfFactor)) '.eps']);
%                     print(1,'-dpng',[depVarCell{p} '_' analRoutine{m} Dot2Underscore(fileExtCell{j}) '_bf' Dot2Underscore(num2str(bonfFactor)) '.png']);
%                 end
            end
        end
    end
end

cd('/u12/smm/public_html/NewFigs/REMPaper/Fig4Examp/')
cwd = pwd;
figNums = 5
cLims = [-0.075 0.075]
cLims = [-4 4]
for j=1:length(analDirs)
    for k=1:length(analRoutine)
        for m=1:length(depVarCell)
            for n=1:length(depVarRefLayerCell)
                cd(analDirs{j})
                PlotGLMResults08('GlmWholeModel08',[analRoutine{k} '_01'],[depVarCell{m} depVarRefLayerCell{n}],spectAnalBaseCell{1},fileExtCell{1},0,'linear',0,cLims)
                aInd1 = strfind(analDirs{j},'sm96');
                aInd2 = strfind(analDirs{j},'/analysis');
                aName = analDirs{j}(aInd1:aInd2-1);
                outdir = [SC(cwd) SC(aName)];
                mkdir(outdir);
                SetFigPos(figNums)
                PrintFigBat(figNums,'-dpng',[outdir dot2underscore([depVarCell{m} depVarRefLayerCell{n} analRoutine{k}])])
            end
        end
    end
end
cd(cwd)

for n=1:length(spectAnalBaseCell)
    for k=1:length(chanLocVersion)
        for m=1:length(analRoutine)
            for j=1:length(fileExtCell)

ExtractGlmCoh09(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs)

ExtractGlmBarh04(depVarCell,spectAnalBaseCell{n},fileExtCell{j},chanLocVersion{k},[analRoutine{m} '_01'],animalDirs)
              end
        end
    end
end
            
              analRoutine = {...
'PhasicVsTonic_MolSD2',...
'PhasicVsMaze_MolSD2',...
'TonicVsMaze_MolSD2',...
    };
   
PlotBehavHist03(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},100,[],[],1)
PlotBehavHist04(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},100,[],[],0,[],'None')

PlotBehavIndepVsDepScat01('speed.p0',depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1})
PlotBehavIndepVsDepScat04(analDirs,indepVar,depVar,fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[],[],[],[],'Sel',[],0)
for j=1:length(animalDirs)
    analDirs = animalDirs{j};
PlotBehavIndepVsDepScat04(analDirs,indepVar,depVar,fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[0 150],[],[],[],'Sel',[],0)
end

ReportFigSM([],['NewFigs/GlmWholeModel08/' analRoutine{1} '/' Dot2Underscore(fileExtCell{1}) '/'])

MakeGLMBetaR2SummaryReport(analRoutine,'_01',spectAnalBaseCell,fileExtCell,depVarCell,plotTypeCell,figNums)

RmGLMPlots(chanLocVersion,analRoutine,'_01',spectAnalBaseCell,fileExtCell,'*PhaseMean*')
 
ReportFigSM([],['NewFigs/GlmWholeModel08/' analRoutine{1} '/' Dot2Underscore(fileExtCell{1}) '/'])

PlotBehavAnatMap04(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[-0.09 0.09])
dbstop in PlotBehavAnatMap06 at 77
PlotBehavAnatMap05(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[])
PlotBehavAnatMap06(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[])

colorScale = [-0.2 0.2]
PlotGLMResults08('GlmWholeModel08',[analRoutine{1} '_01'],[depVarCell{1} depVarRefLayer],spectAnalBaseCell{1},fileExtCell{1},0,'linear',0,colorScale)

% PlotBehavAnatMap02(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[])

% PlotBehavPowerSpectra03(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1})

PlotBehavPowerSpectra04(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[],1,0,[35 75]) 
PlotBehavPowerSpectra05(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[],[],0,25,[35 85],[],[],chanLocVersion{1}) 
% PlotBehavPowerSpectra06(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[],2,0,[35 85],[],[],chanLocVersion{1}) 
ReportFigSM(1,['/u12/smm/public_html/NewFigs/RemPaper/' analRoutine{1} '/' Dot2Underscore(fileExtCell{1}) '/'])

PlotBehavCohSpectra01(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1})
PlotBehavCohSpectra02(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[],[],[],chanLocVersion{1})

diagTrim = 100
diagTrim = 2
PlotCohVsChanDist(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},diagTrim,[],[],chanLocVersion{1})

TestMolPhaseBiphasic01(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},[],[],chanLocVersion{1})


PlotBehavPhaseSpectra03(depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1})

PlotSpectPeakDiffN(analDirs,spectAnalBaseCell{1},fileExtCell{1},analRoutine{1})

GlmWholeModel05(dataDescription,analRoutine,outNameNote,fileExt,depVar,varargin)
GlmWholeModel05(analProgName,analRoutine,nameNote,fileExt,'thetaPowPeak4-12Hz',nchan,0,varargin)

dataStruct = GlmResultsLoad01(depVarCell{1},chanLocVersion{1},spectAnalBaseCell{1},fileExtCell{2},[analRoutine{1} '_01'],animalDirs,'GlmWholeModel08',0);
dataStruct = GlmResultsCatAnimal(dataStruct,0,'pow');
dataStruct = GlmResultsLoad01(depVarCell{1},chanLocVersion{1},spectAnalBaseCell{1},fileExtCell{1},[analRoutine{1} '_01'],analDirs,'GlmWholeModel08',1);
dataStruct = GlmResultsCatAnimal(dataStruct,1,'coh');
anatNames = fieldnames(LoadVar([analDirs{1}{1} 'ChanInfo/ChanLoc_' chanLocVersion{1} fileExtCell{1}]));
GlmResultsMultCompare01(dataStruct.coeffs.task_alter,anatNames);

GlmWholeModel05(analProgName,analRoutine,nameNote,files,fileExt,['thetaCohMedian4-12Hz' selChanName],nchan,0,varargin)
GlmWholeModel05(dataDescription,analRoutine,outNameNote,fileExt,depVar,varargin)
[nChan,freqBool,maxFreq,midPointsBool,minSpeed,winLength] ...
    = DefaultArgs(varargin,{96,0,150,1,0,626});

reportFigBool = 1;
saveDir = 'ThetaPaper/PhaseBehavPlots/chan/allAnimals/';
catMethod = 'trial';
% catMethod = 'chan';
chanLocVersion = 'Min';
% chanLocVersion = 'Full';
PlotBehavPhaseScat03(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},catMethod,chanLocVersion,reportFigBool,saveDir)
% PlotBehavPhaseScat02fig(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{1},0,saveDir)


reportFigBool = 1;
catMethodCell = {'chan','trial'};
chanLocVersion = 'Min';
for k=1:length(catMethodCell)
    for j=1:length(analRoutine)
        saveDir = ['ThetaPaper/PhaseBehavPlots/' catMethodCell{k} '/'];
%         saveDir = ['ThetaPaper/PhaseBehavPlots/' catMethodCell{k} '/' animalDirs{1}{1}(1:5) '/'];
        PlotBehavPhaseScat03(animalDirs,depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{j},catMethodCell{k},chanLocVersion,reportFigBool,saveDir)
    end
end

reportFigBool = 1;
catMethodCell = {'chan','trial'};
chanLocVersion = 'Min';
for k=1:length(catMethodCell)
    for j=1:length(analRoutine)
        for m=1:length(animalDirs)
%         saveDir = ['ThetaPaper/PhaseBehavPlots/' catMethodCell{k} '/'];
        saveDir = ['ThetaPaper/PhaseBehavPlots/' catMethodCell{k} '/' animalDirs{m}{1}(13:18) '/'];
        PlotBehavPhaseScat03(animalDirs(m),depVarCell{1},fileExtCell{1},spectAnalBaseCell{1},analRoutine{j},catMethodCell{k},chanLocVersion,reportFigBool,saveDir)
        end
    end
end

for j=1:14
    set(j,'position',[2 2 6 6])
    set(j,'paperposition',[2 2 6 6])
end

TrialDesigLists09(analRoutine,analDirs)

analRoutine = {...
                'RemVsThetaFreqSelCh1_01'...
                'RemVsRun_01'...
                'RemVsRun_allTrials_01'...
                'RemVsRun_thetaFreqSelCh1_01'...
                'RemVsRun_thetaFreqSelCh1_allTrials_01'...
                'RemVsRunXthetaFreqSelCh1_01'...
                'RemVsRunXthetaFreqSelCh1_allTrials_01'...
                'RemVsRun_thetaFreqSelCh1_X_01'...
                'RemVsRun_thetaFreqSelCh1_X_allTrials_01'...
                'Maze_PCP',...
                'Maze_Scopolamine',...
                'AlterGood_S0_A0_MRall',...
                'AlterGood_MRrctg',...
                'AlterGood_MRrctg_ThetaFreqLM'
                'AlterCenter_S0_A0_E',...
                'AlterGood_S0_A0_MRrdctgw',...
                'AlterGood_MRrctgw',...
                'AlterGood_S0_A0_MRrctgw',...
                'MazeCenterGP_TT',...
                'MazeCenterGP_S0_A0_TT',...
                'RemVsMaze_All',...
                'RemVsMaze_SpeedGE5',...
                'RemVsMaze_SpeedGE5old',...
                'TonicVsPhasic_SD1.5_R2',...
                };
for j=1:length(analRoutine)
    PlotGlmScat03('Min',analRoutine{j});
end



analDirs = {...
            '/BEEF02/smm/sm9614_Analysis/analysis02/',...
            '/BEEF02/smm/sm9608_Analysis/analysis02',...
            '/BEEF01/smm/sm9601_Analysis/analysis03/'...
            '/BEEF01/smm/sm9603_Analysis/analysis04/'...
            }
for k=1:length(analDirs)
    cd(analDirs{k});
    CalcPartCoh01([LoadVar('MazeFiles');LoadVar('RemFiles')],{'.eeg'},[4 12],[60 120]);
end


for j=1:length(analDirs)
    cd(analDirs{j})
    %RecalcThetaGammaRange03(LoadVar('MazeFiles'),fileExtCell,[6 12],[]);
    %RecalcThetaGammaRange03(LoadVar('MazeFiles'),fileExtCell,[],[40 60]);
    %RecalcThetaGammaRange03(LoadVar('MazeFiles'),fileExtCell,[],[40 100]);
    RecalcThetaGammaRange03(LoadVar('FileInfo/MazeFiles'),fileExtCell,[],[40 120],'CalcRunningSpectra12_noExp_MidPoints_MinSpeed0Win626wavParam4');
    RecalcThetaGammaRange03(LoadVar('FileInfo/MazeFiles'),fileExtCell,[],[50 100],'CalcRunningSpectra12_noExp_MidPoints_MinSpeed0Win626wavParam4');
    RecalcThetaGammaRange03(LoadVar('FileInfo/MazeFiles'),fileExtCell,[],[50 120],'CalcRunningSpectra12_noExp_MidPoints_MinSpeed0Win626wavParam4');
    %RecalcThetaGammaRange03(LoadVar('MazeFiles'),fileExtCell,[],[60 120]);
end




